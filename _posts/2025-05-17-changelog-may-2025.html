---
layout: post
status: publish
published: true
title: Обновление инструментов, май 2025
excerpt:
  Новый алгоритм симуляции на основе исторических данных и новая гибкая стратегия
  изъятий в финансовом плане, данные рублевого денежного рынка в бэктестере (с 1996
  года) и обновление в инструменте для анализа фондов.
wordpress_id: 21150
wordpress_url: https://capital-gain.ru/?p=21150
date: '2025-05-17 14:25:01 +0600'
categories:
  - Мета
tags:
  - Инструменты
comments: []
---

<p><!-- wp:paragraph --></p>
<p>
  <a
    href="https://capital-gain.ru/app/planning"
    target="_blank"
    rel="noreferrer noopener"
    >Финансовый план</a
  >:
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  Добавлен
  <strong>новый алгоритм симуляции на основе исторических данных</strong> с
  приращением их количества методом block bootstrap. О самом методе я писал
  подробнее
  <a
    href="https://capital-gain.ru/posts/withdrawal-strategies-modified-bootstrapping/"
    >здесь</a
  >
  &mdash; эти наработки выросли из Jupyter-ноутбука в нормальный код. Вкратце,
  случайная выборка блоков исторических данных позволяет сохранить реальную
  корреляцию между активами в портфеле и инфляцией, а также автокорреляцию в
  рядах данных отдельных активов и инфляции, чем выгодно отличается от полностью
  случайного метода Монте-Карло. Недостаток: у нее &laquo;меньше
  фантазии&raquo;, ведь одинаковые 10-летние блоки прошлых данных просто
  повторяются, хоть и в случайном порядке. Для целей этого инструмента я выбрал
  размер блока данных 10 лет, чтобы более-менее захватывать полные экономические
  циклы.
</p>
<p><!-- /wp:paragraph --></p>
<p>
  <!-- wp:image {"id":21155,"width":"300px","sizeSlug":"full","linkDestination":"none"} -->
</p>
<figure class="wp-block-image size-full is-resized">
  <img
    src="/assets/images/SCR-20250517-oatu.png"
    alt=""
    class="wp-image-21155"
    style="width: 300px" />
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>
  Чтобы воспользоваться новым методом генерации доходностей, надо выбрать его в
  выпадушке в параметрах плана и ниже задать портфель (распределение активов),
  похожий на тот, что вы планируете иметь в определенные годы. Его
  <em>рублевые</em> доходности и инфляция будут использоваться для случайной
  выборки блоков. Из активов доступны зарубежные и российские акции, ОФЗ и корп.
  облигации, денежный рынок и золото. Нельзя сказать, что это покрывает все
  возможные портфели, но для практически полезной симуляции вполне достаточно.
</p>
<p><!-- /wp:paragraph --></p>
<p>
  <!-- wp:image {"id":21156,"sizeSlug":"full","linkDestination":"media"} -->
</p>
<figure class="wp-block-image size-full">
  <a
    href="/assets/images/SCR-20250517-oett.png"
    target="_blank"
    rel=" noreferrer noopener"
    ><img
      src="/assets/images/SCR-20250517-oett.png"
      alt=""
      class="wp-image-21156" /></a
  ><br />
  <figcaption class="wp-element-caption">
    Комиссии и налоги можно задать применительно к каждому из активов. Портфелей
    может быть сколько угодно, например, можно сделать разные веса активов на
    периоды накопления и жизни с капитала.
  </figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>
  Добавлена
  <strong
    >новая гибкая стратегия изъятий
    <a
      href="https://www.bogleheads.org/wiki/Amortization_based_withdrawal"
      target="_blank"
      rel="noreferrer noopener"
      >Amortization based withdrawal (ABW)</a
    ></strong
  >
  с дополнительной возможностью задать максимальный и минимальный лимиты на рост
  или снижение суммы изъятий (с учетом инфляции). Чтобы её настроить, в разделе
  параметров &laquo;Денежные потоки&raquo; надо выбрать тип операции
  &laquo;Вывод&raquo; и далее нажать на кнопку настроек, в которой доступен
  выбор гибких стратегий &mdash;
  <a href="https://capital-gain.ru/posts/withdrawal-strategy-russian-flavour/"
    >Гайтон/Клингер</a
  >
  (был добавлен ранее) или &laquo;Амортизация (ABW)&raquo;.
</p>
<p><!-- /wp:paragraph --></p>
<p>
  <!-- wp:image {"id":21158,"sizeSlug":"large","linkDestination":"none"} -->
</p>
<figure class="wp-block-image size-large">
  <img
    src="/assets/images/SCR-20250517-ofyg-1024x109.png"
    alt=""
    class="wp-image-21158" />
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>
  Подробное описание и примеры в Excel можно найти в Bogleheads Wiki по ссылке
  выше, а в модальном окне самого инструмента есть формула PMT с используемыми
  параметрами и довольно подробное описание переменной темпа роста изъятий
  <em>g</em>, которую вы скорее всего захотите настроить.
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:quote --></p>
<blockquote class="wp-block-quote">
  <p><!-- wp:paragraph --></p>
  <p>
    Расчет суммы изъятия в каждом году производится аналогично функции PMT из
    Excel:&nbsp;<code>PMT(реальная доходность / (1 + g), Nper, -PV, FV, 1)</code
    >, где&nbsp;<em>g</em>&nbsp;&mdash; темп роста
    изъятий,&nbsp;<em>Nper</em>&nbsp;&mdash; количество лет до конца
    плана,&nbsp;<em>PV</em>&nbsp;&mdash; капитал в текущем году (present
    value),&nbsp;<em>FV</em>&nbsp;&mdash; минимальный порог капитала из настроек
    плана, увеличенный на инфляцию к текущему году и уменьшенный на (1 +
    g)<sup>Nper</sup>&nbsp;(future value),&nbsp;<em>1</em>&nbsp;&mdash; означает
    платеж в начале года.
  </p>
  <p><!-- /wp:paragraph --></p>
  <p><!-- wp:paragraph --></p>
  <p>
    По-умолчанию&nbsp;<em>g</em>&nbsp;= 0, что соответствует нейтральной
    траектории изъятий, зависящей только от ставки доходности, числа оставшихся
    периодов и значений капитала. Положительное
    значение&nbsp;<em>g</em>&nbsp;делает стратегию более консервативной: изъятия
    начинаются с меньшей суммы и в течение всего периода растут с указанным
    темпом, что создает положительный наклон кривой изъятий относительно
    нейтральной траектории. Отрицательное значение&nbsp;<em>g</em>&nbsp;делает
    стратегию более агрессивной и позволяет выводить больше денег из портфеля в
    начале периода, постепенно уменьшая сумму изъятий (отрицательный наклон).
  </p>
  <p><!-- /wp:paragraph --></p>
  <p><!-- wp:paragraph --></p>
  <p>
    Получившиеся суммы изъятий можно будет увидеть только после расчета плана во
    вкладке &laquo;Визуализация&raquo;. Если&nbsp;<em>g</em>&nbsp;= 0, суммы
    обычно получаются более высокими, чем при ставке изъятий &le; 4%, потому что
    эта стратегия стремится использовать весь капитал до указанного минимального
    порога. Вы можете подобрать такое значение&nbsp;<em>g</em>, при котором
    начальная сумма вывода будет равна сумме при желаемой ставке SWR (safe
    withdrawal rate), получив таким образом гибкую стратегию на основе
    фиксированной SWR с большей вероятностью успеха.
  </p>
  <p><!-- /wp:paragraph --></p>
</blockquote>
<p><!-- /wp:quote --></p>
<p><!-- wp:paragraph --></p>
<p>
  Не могу сказать, что все эти концепции очень простые &mdash; это уже
  территория, где не помешают некоторые знания из области анализа данных,
  базовых финансов и
  <a href="https://capital-gain.ru/posts/withdrawal-strategies-comparison/"
    >гибких стратегий</a
  >
  вывода денег из инвест. портфелей. Если всё это кажется непонятным, рекомендую
  сходить по ссылкам и ознакомиться с теорией, а уже затем использовать.
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  Добавлена
  <strong
    >возможность посмотреть графики капитала и сумм вывода в сегодняшних
    деньгах</strong
  >, когда в параметрах плана указана инфляция (в случае Монте-Карло симуляции)
  или используется историческая инфляция (когда выбран новый тип генерации
  &mdash; бутстрап прошлых данных).
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  <a
    href="https://capital-gain.ru/app/rebalance"
    target="_blank"
    rel="noreferrer noopener"
    >Ребалансировка портфеля</a
  >: в очередной раз улучшен алгоритм ребалансировки и, кажется, теперь я им
  доволен.
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  <a
    href="https://capital-gain.ru/app/backtest"
    target="_blank"
    rel="noreferrer noopener"
    >Бэктестер (анализ портфелей)</a
  >: добавлены данные рублевого денежного рынка по годовым ставкам однодневных
  кредитов с 1996 года (по данным RUSFARIND &mdash; МосБиржа, RUONIA и MIACR
  &mdash; ЦБ). Однодневное РЕПО используют фонды денежного рынка.
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  <strong
    >&laquo;Сравнение фондов&raquo; и &laquo;Сводка по комиссиям&raquo; были
    удалены</strong
  >. Мне надоело их постоянно обновлять, это время можно потратить на что-нибудь
  более полезное. К тому же я заметил, что сам ими не пользуюсь, а это один из
  главных критериев, по которым я определяю, стоит ли тратить время на
  разработку. В итоге решил, что смысла поддерживать их дальше нет. Для поиска и
  просмотра информации о фондах есть
  <a
    href="https://rusetfs.com/screener"
    target="_blank"
    rel="noreferrer noopener"
    >rusetfs.com</a
  >
  и
  <a
    href="https://investfunds.ru/funds/"
    target="_blank"
    rel="noreferrer noopener nofollow"
    >investfunds.ru</a
  >, которые занимаются сбором информации активнее и глубже. Да, у меня были
  некоторые уникальные фишки, связанные, например, с метриками отслеживания
  индекса, но для детального анализа фондов лучше использовать другой
  инструмент, который тоже получил обновление…
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>
  <a
    href="https://capital-gain.ru/app/funds/analyse"
    target="_blank"
    rel="noreferrer noopener"
    >Анализ фондов</a
  >: добавлена возможность загрузить данные по расчетным или биржевым ценам для
  БПИФ прямо в UI. Достаточно указать тикер фонда на МосБирже, тип цен, выбрать
  торговую сессию и нажать кнопочку загрузки. Также теперь можно отфильтровать
  полученные любым из способов данные по датам начала и конца периода.
</p>
<p><!-- /wp:paragraph --></p>
<p>
  <!-- wp:image {"id":21159,"sizeSlug":"full","linkDestination":"media"} -->
</p>
<figure class="wp-block-image size-full">
  <a
    href="/assets/images/SCR-20250517-olsu.png"
    target="_blank"
    rel=" noreferrer noopener"
    ><img
      src="/assets/images/SCR-20250517-olsu.png"
      alt=""
      class="wp-image-21159"
  /></a>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>
  Напомню, что инструмент поддерживает анализ и сравнение до 5 фондов с 5
  индексами и между собой одновременно, что позволяет на одном экране детально
  проанализировать качество работы и сравнить фонды из любой узкой ниши (на
  одинаковые или похожие активы).
</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>P. S. Если какие-то новые функции не отображаются, обновите страницу.</p>
<p><!-- /wp:paragraph --></p>
