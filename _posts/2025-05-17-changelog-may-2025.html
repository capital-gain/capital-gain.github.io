---
layout: post
status: publish
published: true
title: Обновление инструментов, май 2025
excerpt:
  Новый алгоритм симуляции на основе исторических данных и новая гибкая стратегия
  изъятий в финансовом плане, данные рублевого денежного рынка в бэктестере (с 1996
  года) и обновление в инструменте для анализа фондов.
wordpress_id: 21150
date: '2025-05-17 14:25:01 +0600'
categories:
  - Мета
tags:
  - Жизнь с капитала
  - Инструменты
comments: []
---

<p>
  <a
    href="https://capital-gain.ru/app/planning"
    target="_blank"
    rel="noreferrer noopener"
    >Финансовый план</a
  >:
</p>

<p>
  Добавлен
  <strong>новый алгоритм симуляции на основе исторических данных</strong> с
  приращением их количества методом block bootstrap. О самом методе я писал
  подробнее
  <a
    href="{% post_url 2024-01-16-withdrawal-strategies-modified-bootstrapping %}"
    >здесь</a
  >
  — эти наработки выросли из Jupyter-ноутбука в нормальный код. Вкратце,
  случайная выборка блоков исторических данных позволяет сохранить реальную
  корреляцию между активами в портфеле и инфляцией, а также автокорреляцию в
  рядах данных отдельных активов и инфляции, чем выгодно отличается от полностью
  случайного метода Монте-Карло. Недостаток: у нее «меньше фантазии», ведь
  одинаковые 10-летние блоки прошлых данных просто повторяются, хоть и в
  случайном порядке. Для целей этого инструмента я выбрал размер блока данных 10
  лет, чтобы более-менее захватывать полные экономические циклы.
</p>

<figure>
  <img src="/assets/images/SCR-20250517-oatu.png" style="max-width: 300px" />
</figure>

<p>
  Чтобы воспользоваться новым методом генерации доходностей, надо выбрать его в
  выпадушке в параметрах плана и ниже задать портфель (распределение активов),
  похожий на тот, что вы планируете иметь в определенные годы. Его
  <em>рублевые</em> доходности и инфляция будут использоваться для случайной
  выборки блоков. Из активов доступны зарубежные и российские акции, ОФЗ и корп.
  облигации, денежный рынок и золото. Нельзя сказать, что это покрывает все
  возможные портфели, но для практически полезной симуляции вполне достаточно.
</p>

<figure>
  <a
    href="/assets/images/SCR-20250517-oett.png"
    target="_blank"
    rel=" noreferrer noopener"
    ><img src="/assets/images/SCR-20250517-oett.png"
  /></a>
  <figcaption>
    Комиссии и налоги можно задать применительно к каждому из активов. Портфелей
    может быть сколько угодно, например, можно сделать разные веса активов на
    периоды накопления и жизни с капитала.
  </figcaption>
</figure>

<p>
  Добавлена
  <strong
    >новая гибкая стратегия изъятий
    <a
      href="https://www.bogleheads.org/wiki/Amortization_based_withdrawal"
      target="_blank"
      rel="noreferrer noopener"
      >Amortization based withdrawal (ABW)</a
    ></strong
  >
  с дополнительной возможностью задать максимальный и минимальный лимиты на рост
  или снижение суммы изъятий (с учетом инфляции). Чтобы её настроить, в разделе
  параметров «Денежные потоки» надо выбрать тип операции «Вывод» и далее нажать
  на кнопку настроек, в которой доступен выбор гибких стратегий —
  <a href="{% post_url 2023-08-12-withdrawal-strategy-russian-flavour %}"
    >Гайтон/Клингер</a
  >
  (был добавлен ранее) или «Амортизация (ABW)».
</p>

<figure>
  <img src="/assets/images/SCR-20250517-ofyg-1024x109.png" />
</figure>

<p>
  Подробное описание и примеры в Excel можно найти в Bogleheads Wiki по ссылке
  выше, а в модальном окне самого инструмента есть формула PMT с используемыми
  параметрами и довольно подробное описание переменной темпа роста изъятий
  <em>g</em>, которую вы скорее всего захотите настроить.
</p>

<blockquote>
  <p>
    Расчет суммы изъятия в каждом году производится аналогично функции PMT из
    Excel: <code>PMT(реальная доходность / (1 + g), Nper, -PV, FV, 1)</code>,
    где <em>g</em> — темп роста изъятий, <em>Nper</em> — количество лет до конца
    плана, <em>PV</em> — капитал в текущем году (present value), <em>FV</em> —
    минимальный порог капитала из настроек плана, увеличенный на инфляцию к
    текущему году и уменьшенный на (1 + g)<sup>Nper</sup> (future value),
    <em>1</em> — означает платеж в начале года.
  </p>

  <p>
    По-умолчанию <em>g</em> = 0, что соответствует нейтральной траектории
    изъятий, зависящей только от ставки доходности, числа оставшихся периодов и
    значений капитала. Положительное значение <em>g</em> делает стратегию более
    консервативной: изъятия начинаются с меньшей суммы и в течение всего периода
    растут с указанным темпом, что создает положительный наклон кривой изъятий
    относительно нейтральной траектории. Отрицательное значение
    <em>g</em> делает стратегию более агрессивной и позволяет выводить больше
    денег из портфеля в начале периода, постепенно уменьшая сумму изъятий
    (отрицательный наклон).
  </p>

  <p>
    Получившиеся суммы изъятий можно будет увидеть только после расчета плана во
    вкладке «Визуализация». Если <em>g</em> = 0, суммы обычно получаются более
    высокими, чем при ставке изъятий ≤ 4%, потому что эта стратегия стремится
    использовать весь капитал до указанного минимального порога. Вы можете
    подобрать такое значение <em>g</em>, при котором начальная сумма вывода
    будет равна сумме при желаемой ставке SWR (safe withdrawal rate), получив
    таким образом гибкую стратегию на основе фиксированной SWR с большей
    вероятностью успеха.
  </p>
</blockquote>

<p>
  Не могу сказать, что все эти концепции очень простые — это уже территория, где
  не помешают некоторые знания из области анализа данных, базовых финансов и
  <a href="{% post_url 2023-09-18-withdrawal-strategies-comparison %}"
    >гибких стратегий</a
  >
  вывода денег из инвест. портфелей. Если всё это кажется непонятным, рекомендую
  сходить по ссылкам и ознакомиться с теорией, а уже затем использовать.
</p>

<p>
  Добавлена
  <strong
    >возможность посмотреть графики капитала и сумм вывода в сегодняшних
    деньгах</strong
  >, когда в параметрах плана указана инфляция (в случае Монте-Карло симуляции)
  или используется историческая инфляция (когда выбран новый тип генерации —
  бутстрап прошлых данных).
</p>

<p>
  <a
    href="https://capital-gain.ru/app/rebalance"
    target="_blank"
    rel="noreferrer noopener"
    >Ребалансировка портфеля</a
  >: в очередной раз улучшен алгоритм ребалансировки и, кажется, теперь я им
  доволен.
</p>

<p>
  <a
    href="https://capital-gain.ru/app/backtest"
    target="_blank"
    rel="noreferrer noopener"
    >Бэктестер (анализ портфелей)</a
  >: добавлены данные рублевого денежного рынка по годовым ставкам однодневных
  кредитов с 1996 года (по данным RUSFARIND — МосБиржа, RUONIA и MIACR — ЦБ).
  Однодневное РЕПО используют фонды денежного рынка.
</p>

<p>
  <strong>«Сравнение фондов» и «Сводка по комиссиям» были удалены</strong>. Мне
  надоело их постоянно обновлять, это время можно потратить на что-нибудь более
  полезное. К тому же я заметил, что сам ими не пользуюсь, а это один из главных
  критериев, по которым я определяю, стоит ли тратить время на разработку. В
  итоге решил, что смысла поддерживать их дальше нет. Для поиска и просмотра
  информации о фондах есть
  <a
    href="https://rusetfs.com/screener"
    target="_blank"
    rel="noreferrer noopener"
    >rusetfs.com</a
  >
  и
  <a
    href="https://investfunds.ru/funds/"
    target="_blank"
    rel="noreferrer noopener nofollow"
    >investfunds.ru</a
  >, которые занимаются сбором информации активнее и глубже. Да, у меня были
  некоторые уникальные фишки, связанные, например, с метриками отслеживания
  индекса, но для детального анализа фондов лучше использовать другой
  инструмент, который тоже получил обновление…
</p>

<p>
  <a
    href="https://capital-gain.ru/app/funds/analyse"
    target="_blank"
    rel="noreferrer noopener"
    >Анализ фондов</a
  >: добавлена возможность загрузить данные по расчетным или биржевым ценам для
  БПИФ прямо в UI. Достаточно указать тикер фонда на МосБирже, тип цен, выбрать
  торговую сессию и нажать кнопочку загрузки. Также теперь можно отфильтровать
  полученные любым из способов данные по датам начала и конца периода.
</p>

<figure>
  <a
    href="/assets/images/SCR-20250517-olsu.png"
    target="_blank"
    rel=" noreferrer noopener"
    ><img src="/assets/images/SCR-20250517-olsu.png"
  /></a>
</figure>

<p>
  Напомню, что инструмент поддерживает анализ и сравнение до 5 фондов с 5
  индексами и между собой одновременно, что позволяет на одном экране детально
  проанализировать качество работы и сравнить фонды из любой узкой ниши (на
  одинаковые или похожие активы).
</p>

<p>P. S. Если какие-то новые функции не отображаются, обновите страницу.</p>
