---
layout: post
status: publish
published: true
title: Новый инструмент ребалансировки портфелей
author:
  display_name: Дмитрий Никитенко
  login: Dmitry
  email: dima.nikitenko@gmail.com
  url: https://capital-gain.ru
author_login: Dmitry
author_email: dima.nikitenko@gmail.com
author_url: https://capital-gain.ru
excerpt: Инструмент для ребалансировки портфелей, который делает больше, чем обычный
  Excel. Бесплатный и безопасный для ваших финансовых данных - не хранит их на сервере.
wordpress_id: 12588
wordpress_url: https://capital-gain.ru/?p=12588
date: '2021-01-13 18:53:00 +0600'
date_gmt: '2021-01-13 15:53:00 +0600'
categories:
- Мета
tags:
- Инструменты
- Ребалансировка
comments: []
---
<p><!-- wp:paragraph --></p>
<p>Со временем изначальное распределение активов в портфеле меняется вслед за изменением цен на них. Ребалансировка позволяет вернуть доли активов в портфеле к изначальным через их покупку или продажу. О том зачем это нужно и когда стоит делать ребалансировку можно узнать <a href="https://capital-gain.ru/posts/asset-allocation-portfolio-effect/">в этой статье</a>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>Обычный подход</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Чтобы ребалансировать портфель, надо вычислить количество лотов к покупке или продаже по каждому активу. Самое простое решение этой задачи можно сделать в любой электронной таблице с помощью формулы: <code>(текущая стоимость портфеля + сумма пополнения) * целевая доля актива / текущая цена актива - количество лотов во владении</code>. Если нет возможности работать с неполными лотами на бирже, результат формулы можно округлять в меньшую сторону. Пример такой таблицы <a rel="noreferrer noopener" href="https://docs.google.com/spreadsheets/d/16YwFW3VD3-382oqnJ7aio-Q_rzOztIATY1xYKluq17E/edit?usp=sharing" data-type="URL" data-id="https://docs.google.com/spreadsheets/d/16YwFW3VD3-382oqnJ7aio-Q_rzOztIATY1xYKluq17E/edit?usp=sharing" target="_blank">доступен здесь</a>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Но это решает только часть задачи. Представьте, что какие-то активы вы не хотите продавать или покупать, а остатки на счетах не всегда можно вывести на другой счет, чтобы докупить на нём бумаги. Например:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul>
<li>продажа актива на налогооблагаемом или зарубежном брокерском счете не желательна (не хотите платить налог или подавать декларацию, если используете фонды с реинвестированием и других доходов по счету нет)</li>
<li>использование нескольких счетов, один из которых ИИС (нельзя вывести деньги без закрытия счета, чтобы купить на них бумаги на другом счете).</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Могут быть и другие неудобства, например, в обычной электронной таблице сложно учесть комиссии за совершение операций или распределить остатки, возникшие от округления лотов. Во всех этих случаях вместо автоматической формулы придется тратить время на ручной подбор количества лотов к покупке или продаже по каждому активу.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>Инструмент ребалансировки от Capital-Gain</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Более универсальным подходом является ребалансировка в несколько этапов, которую использует <a href="https://capital-gain.ru/app/rebalance" data-type="URL" data-id="https://capital-gain.ru/app/rebalance" target="_blank" rel="noreferrer noopener">мой инструмент</a>. Он работает примерно так:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul>
<li>Сначала количество лотов к покупке или продаже считается по похожей формуле, но при необходимости частичными шагами, чтобы распределить имеющиеся деньги (в том числе вырученные с продажи отклоняющихся в плюс активов, если такие были) более равномерно и сперва на активы с наибольшим отклонением.</li>
<li>Затем неизрасходованные после первого этапа средства распределяются по активам с помощью генетического алгоритма, похожего на эволюцию в природе. Он создает множество случайных мутаций (вариантов) портфеля и отбирает тот вариант, в котором отклонения от целевых долей, брокерские комиссии и остаток неизрасходованных средств оказались минимальными.</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Это дает возможность запретить продажу или покупку конкретных активов в портфеле, учесть комиссии брокера и биржи и получить более оптимальные результаты ребалансировки без лишних усилий.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Возьмем в качестве примера данные из той же таблице, на которую я ссылался выше. Но дополним их наличием двух счетов с указанным размером комиссий по ним. Простейший случай дает нам практически те же результаты:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":5051,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="/assets/images/rebalancing-1.png" target="_blank" rel="noopener"><img src="/assets/images/rebalancing-1-1024x554.png" alt="" class="wp-image-5051"/></a></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Несмотря на наличие комиссий, итоговая стоимость портфеля оказалась чуть выше, а использование суммы пополнения максимальным. Усложним ситуацию, отправив актив Деньги (например, это мог быть фонд денежного рынка или короткая облигация) на другой счет (деньги между счетами в ходе ребалансировки не переводятся) и также запретив его продажу:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":5052,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="/assets/images/rebalancing-2.png" target="_blank" rel="noopener"><img src="/assets/images/rebalancing-2-1024x561.png" alt="" class="wp-image-5052"/></a></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Указанная сумма пополнения позволяет несколько сильнее сгладить отклонения. Чтобы ещё усложнить задачу, сделаем ребалансировку без пополнений:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":5053,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="/assets/images/rebalancing-3.png" target="_blank" rel="noopener"><img src="/assets/images/rebalancing-3-1024x558.png" alt="" class="wp-image-5053"/></a></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Ограничительные условия и отсутствие пополнения усложняют ребалансировку, но она продолжает работать так хорошо, как позволяют входные данные.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Ссылка на новый инструмент: <a href="https://capital-gain.ru/app/rebalance">https://capital-gain.ru/app/rebalance</a></p>
<p><!-- /wp:paragraph --></p>
